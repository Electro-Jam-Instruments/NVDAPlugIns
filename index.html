<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NVDA Plugins - Electro Jam Instruments</title>
  <style>
    :root { color-scheme: light dark; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem;
      background: Canvas;
      color: CanvasText;
      line-height: 1.6;
    }
    h1, h2, h3 { color: CanvasText; margin-top: 1.5rem; }
    h1 { border-bottom: 2px solid CanvasText; padding-bottom: 0.5rem; }
    .plugin-card {
      background: color-mix(in srgb, CanvasText 5%, Canvas);
      padding: 1.5rem;
      border-radius: 8px;
      margin: 1.5rem 0;
      border: 1px solid color-mix(in srgb, CanvasText 15%, Canvas);
    }
    .download-section {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin: 1rem 0;
    }
    .download-btn {
      display: inline-block;
      padding: 0.75rem 1.25rem;
      text-decoration: none;
      border-radius: 6px;
      font-weight: 500;
    }
    .download-btn:focus {
      outline: 3px solid CanvasText;
      outline-offset: 2px;
    }
    .download-stable {
      background: #2563eb;
      color: white;
    }
    .download-beta {
      background: color-mix(in srgb, CanvasText 20%, Canvas);
      color: CanvasText;
      border: 1px solid color-mix(in srgb, CanvasText 30%, Canvas);
    }
    .version-info {
      font-size: 0.9rem;
      color: GrayText;
      margin-top: 0.5rem;
    }
    .changelog-toggle {
      background: none;
      border: 1px solid color-mix(in srgb, CanvasText 30%, Canvas);
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      color: CanvasText;
      margin-top: 1rem;
    }
    .changelog-toggle:focus {
      outline: 2px solid CanvasText;
      outline-offset: 2px;
    }
    .changelog {
      display: none;
      margin-top: 1rem;
      padding: 1rem;
      background: color-mix(in srgb, CanvasText 10%, Canvas);
      border-radius: 4px;
      max-height: 300px;
      overflow-y: auto;
    }
    .changelog.show { display: block; }
    .changelog h3 { margin-top: 0.5rem; }
    .changelog ul { margin: 0.5rem 0; padding-left: 1.5rem; }
    .requirements {
      font-size: 0.95rem;
      margin: 0.5rem 0;
    }
    .install-steps {
      background: color-mix(in srgb, CanvasText 8%, Canvas);
      padding: 1rem 1.5rem;
      border-radius: 6px;
      margin: 1rem 0;
    }
    .install-steps ol { margin: 0.5rem 0; padding-left: 1.5rem; }
    code {
      background: color-mix(in srgb, CanvasText 15%, Canvas);
      padding: 0.15rem 0.4rem;
      border-radius: 3px;
      font-size: 0.95em;
    }
    footer {
      margin-top: 3rem;
      padding-top: 1rem;
      border-top: 1px solid color-mix(in srgb, CanvasText 20%, Canvas);
      color: GrayText;
      text-align: center;
    }
    a { color: LinkText; }
    a:visited { color: VisitedText; }
  </style>
</head>
<body>
  <h1>NVDA Plugins</h1>
  <p>Accessibility add-ons for the <a href="https://www.nvaccess.org/">NVDA screen reader</a> by Electro Jam Instruments.</p>

  <div class="plugin-card">
    <h2>PowerPoint Comments</h2>
    <p>Hear comment counts when navigating slides. Read presenter notes with a keyboard shortcut. Works in both edit mode and slideshow mode.</p>
    <p class="requirements"><strong>Requirements:</strong> NVDA 2024.1+, Microsoft PowerPoint 365</p>

    <div class="download-section">
      <a class="download-btn download-stable" href="downloads/powerpoint-comments-latest.nvda-addon" id="ppt-stable">
        Download Stable
      </a>
      <a class="download-btn download-beta" href="downloads/powerpoint-comments-latest-beta.nvda-addon" id="ppt-beta">
        Download Beta
      </a>
    </div>
    <p class="version-info" id="ppt-versions">Check GitHub releases for version info</p>

    <button class="changelog-toggle" onclick="toggleChangelog('ppt-changelog')" aria-expanded="false" aria-controls="ppt-changelog">
      View Changelog
    </button>
    <div class="changelog" id="ppt-changelog" role="region" aria-label="PowerPoint Comments changelog">
      <p>Loading changelog...</p>
    </div>
  </div>

  <div class="plugin-card">
    <h2>Windows Dictation Silence</h2>
    <p>Automatically silences NVDA when Windows Voice Typing (Win+H) is active. Speech restores instantly when you press any key to close dictation.</p>
    <p class="requirements"><strong>Requirements:</strong> NVDA 2024.1+, Windows 11</p>

    <div class="download-section">
      <a class="download-btn download-stable" href="downloads/windows-dictation-silence-latest.nvda-addon" id="wds-stable">
        Download Stable
      </a>
      <a class="download-btn download-beta" href="downloads/windows-dictation-silence-latest-beta.nvda-addon" id="wds-beta">
        Download Beta
      </a>
    </div>
    <p class="version-info" id="wds-versions">Check GitHub releases for version info</p>

    <button class="changelog-toggle" onclick="toggleChangelog('wds-changelog')" aria-expanded="false" aria-controls="wds-changelog">
      View Changelog
    </button>
    <div class="changelog" id="wds-changelog" role="region" aria-label="Windows Dictation Silence changelog">
      <p>Loading changelog...</p>
    </div>
  </div>

  <div class="install-steps">
    <h2>Installation</h2>
    <ol>
      <li>Download the <code>.nvda-addon</code> file</li>
      <li>Open the file (double-click or press Enter)</li>
      <li>Confirm installation when NVDA prompts</li>
      <li>Restart NVDA when prompted</li>
    </ol>
    <p>For addon management help, see the <a href="https://www.nvaccess.org/files/nvda/documentation/userGuide.html#AddonsManager">NVDA User Guide</a>.</p>
  </div>

  <h2>Source Code &amp; Issues</h2>
  <p>
    <a href="https://github.com/Electro-Jam-Instruments/NVDAPlugIns">GitHub Repository</a> -
    Report bugs, request features, or contribute code.
  </p>

  <footer>
    <p>&copy; 2026 Electro Jam Instruments</p>
    <p>Licensed under GPL v2.0</p>
  </footer>

  <script>
    function toggleChangelog(id) {
      const el = document.getElementById(id);
      const btn = el.previousElementSibling;
      const isShown = el.classList.toggle('show');
      btn.setAttribute('aria-expanded', isShown);
    }

    // Load changelogs dynamically
    async function loadChangelog(plugin, elementId) {
      try {
        const response = await fetch(`api/${plugin}-changelog.md`);
        if (response.ok) {
          const text = await response.text();
          // Simple markdown to HTML for changelog
          const html = text
            .replace(/^## \[([^\]]+)\]/gm, '<h3>Version $1</h3>')
            .replace(/^### (.+)$/gm, '<h4>$1</h4>')
            .replace(/^- (.+)$/gm, '<li>$1</li>')
            .replace(/(<li>.*<\/li>\n?)+/g, '<ul>$&</ul>')
            .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
            .replace(/`([^`]+)`/g, '<code>$1</code>');
          document.getElementById(elementId).innerHTML = html;
        }
      } catch (e) {
        console.log('Could not load changelog for ' + plugin);
      }
    }

    // Load version info
    async function loadVersionInfo(plugin, stableId, betaId, versionsId) {
      // Check if files exist by trying to fetch headers
      const stableBtn = document.getElementById(stableId);
      const betaBtn = document.getElementById(betaId);

      try {
        const stableResp = await fetch(stableBtn.href, { method: 'HEAD' });
        if (!stableResp.ok) {
          stableBtn.style.display = 'none';
        }
      } catch (e) {
        stableBtn.style.display = 'none';
      }

      try {
        const betaResp = await fetch(betaBtn.href, { method: 'HEAD' });
        if (!betaResp.ok) {
          betaBtn.style.display = 'none';
        }
      } catch (e) {
        betaBtn.style.display = 'none';
      }
    }

    // Initialize
    loadChangelog('powerpoint-comments', 'ppt-changelog');
    loadChangelog('windows-dictation-silence', 'wds-changelog');
    loadVersionInfo('powerpoint-comments', 'ppt-stable', 'ppt-beta', 'ppt-versions');
    loadVersionInfo('windows-dictation-silence', 'wds-stable', 'wds-beta', 'wds-versions');
  </script>
</body>
</html>
